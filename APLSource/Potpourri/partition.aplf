 partition←{

     2>|≡⍺:(,⊂⍺)∇⍵
     1=≢⍺: (⍺,(⊂,(≢1⊃⍺)⍴1),(⊂,(≢⍴⍵)⍴1))∇⍵
     2=≢⍺: (⍺,⊂(≢⍴⍵)⍴1)∇⍵
     (shape movement first)←⍺
     ⍵<⍥(≢⍴)shape:0⍴⊂shape⍴0
     tmp←({⊂⍺ ⍵}⌺(⌽1+(≢⍴⍵)↑¯1+⌽shape))⍵
     tmp2←,tmp
     res←(⊂shape)⍴¨(∧/¨0=1⊃¨tmp2)/2⊃¨tmp2
     res
 }
