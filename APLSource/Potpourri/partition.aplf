 partition←{
     spec←,⊆⍺
     movement_default←(≢1⊃spec)⍴1
     first_default←(≢⍴⍵)⍴1
     (shape movement first)←⌽¯3↑first_default movement_default,⌽spec
     array←(¯1+first)↓⍵
     shape←⌽1+(≢⍴array)↑¯1+⌽shape
     movement←⌽1+(≢⍴array)↑¯1+⌽movement
     ∨/shape>⍴array:0⍴⊂shape⍴array
     tmp←({⊂⍺↓⍵}⌺shape)array
     i_keep←(⍸(⊂shape)≡¨⍴¨tmp)
     i_start←⊃⌊/i_keep
     i_final←(∧/¨0=(⊂movement)|(i_keep-⊂i_start))/i_keep
     ⊃¨i_final⌷¨⊂tmp
 }
