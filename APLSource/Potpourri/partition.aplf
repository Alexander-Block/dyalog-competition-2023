 partition←{

     2>|≡⍺:(,⊂⍺)∇⍵
     1=≢⍺: (⍺,(⊂,(≢1⊃⍺)⍴1),(⊂,(≢⍴⍵)⍴1))∇⍵
     2=≢⍺: (⍺,⊂(≢⍴⍵)⍴1)∇⍵
     shape←1⊃,⍺
     ⍵<⍥(≢⍴)shape:0⍴⊂shape⍴0
     tmp←,({⊂⍺ ⍵}⌺(⌽1+(≢⍴⍵)↑¯1+⌽shape))⍵
     res←(⊂shape)⍴¨(∧/¨0=1⊃¨tmp)/2⊃¨tmp
     res
 }
